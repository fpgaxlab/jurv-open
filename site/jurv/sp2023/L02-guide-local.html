<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>FPGA验证流程（本地实验版） :: 计算机组成与CPU设计实验</title>
    <meta name="generator" content="Antora 3.1.2">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">计算机组成与CPU设计实验</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jurv" data-version="sp2023">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">计算机组成与CPU设计实验</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">前言</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="brief-of-parts.html">实验内容的组织</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="video-links.html">教学视频资源</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">实验环境</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="L02-lab-tools.html">实验环境概述</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="L01-guide.html">Quartus FPGA设计流程</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L01-guide.html#准备工作">准备工作</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L01-guide.html#实验步骤">实验步骤</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L01-guide.html#云端编译">云端编译</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L01b-tcl-create-quartus-project.html">用TCL文件快速创建工程</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="L01-guide.html#验证设计">设计的实验验证</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="L02-guide-remote.html">远程实验验证流程</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="L02-guide-remote.html#准备工作">准备工作</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="L02-guide-login.html">登录远程实验平台</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-remote.html#验证流程">验证流程</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-remote.html#设计虚拟面板">设计虚拟面板</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-remote.html#实验考核">实验考核</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="L02-guide-local.html">本地实验验证流程</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#准备工作">准备工作</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#验证流程">验证流程</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#设计虚拟面板">设计虚拟面板</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#Quartus下载sof">使用Quartus软件下载sof文件</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">SystemVerilog和逻辑电路实验</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">计算机组成实验</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">RISC-V CPU设计实验</span>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">计算机组成与CPU设计实验</span>
    <span class="version">sp2023</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="index.html">计算机组成与CPU设计实验</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">sp2023</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../teach/index.html">FPGA实验云 ● 教师指南</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../teach/index.html">default</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">计算机组成与CPU设计实验</a></li>
    <li>实验环境</li>
    <li><a href="L02-guide-local.html">本地实验验证流程</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">FPGA验证流程（本地实验版）</h1>
<div class="sect1">
<h2 id="_实验目的"><a class="anchor" href="#_实验目的"></a>实验目的</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>熟悉FPGA实验验证流程；</p>
</li>
<li>
<p>熟悉实验调试软件的使用方法；</p>
</li>
<li>
<p>熟悉实验板的输入输出元件。</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_实验设备"><a class="anchor" href="#_实验设备"></a>实验设备</h2>
<div class="sectionbody">
<div class="paragraph">
<p>实验调试软件：Windows版WeLab实验软件。</p>
</div>
<div class="paragraph">
<p>实验板：以下任选一种，本文举例以Pocket口袋实验板为主。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Pocket口袋实验板（内含调试适配器和FPGA编程器）</p>
</li>
<li>
<p>DE2-115开发板和JUPOD调试适配器</p>
</li>
<li>
<p>Nexys4 DDR开发板和JUPOD调试适配器</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="准备工作"><a class="anchor" href="#准备工作"></a>准备工作</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_实验板硬件连接"><a class="anchor" href="#_实验板硬件连接"></a>实验板硬件连接</h3>
<div class="paragraph">
<p>实验软件可与多种硬件实验板配套，大致分为两种类型，一种是独立的调试适配器+实验/开发板，如DE2-115；另一种是实验板内置调试适配器，如Pocket口袋板。</p>
</div>
<div class="sect3">
<h4 id="_pocket口袋板"><a class="anchor" href="#_pocket口袋板"></a>Pocket口袋板</h4>
<div class="paragraph">
<p>Pocket口袋板和PC机通过USB电缆连接后，口袋板上的蓝色电源指示灯点亮，右侧16个红色灯和8个绿色灯也处于半亮状态。在电脑驱动尚未成功识别口袋板时，左下角的红色DATA指示灯亮；识别到口袋板后，红灯熄灭、绿色LINK指示灯点亮。电脑识别设备的时间并不确定，一般首次连接到的电脑需要的时间稍长。如果电脑尚未安装驱动程序，请参阅步骤2安装驱动程序。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/L02b-image1.jpeg" alt="IMG_9130_裁剪" width="294" height="227"></span></p>
</div>
<div class="paragraph">
<p>图 1 Pocket口袋实验板</p>
</div>
</div>
<div class="sect3">
<h4 id="_de2_115_jupod调试适配器"><a class="anchor" href="#_de2_115_jupod调试适配器"></a>DE2-115 + JUPOD调试适配器</h4>
<div class="paragraph">
<p>JUPOD调试适配器通过USB电缆连接PC机，通过扁平电缆连接DE2-115开发板左侧14脚扩展接口。DE2-115开发板上电后，蓝色指示灯点亮。在电脑驱动尚未成功识别JUPOD调试适配器时，双色指示灯的红色灯亮；识别到口袋板后，红灯熄灭、绿色灯点亮。电脑识别设备的时间并不确定，一般首次连接到的电脑需要的时间稍长。如果电脑尚未安装驱动程序，请参阅步骤2安装驱动程序。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/L02b-image2.jpeg" alt="D:\Develop\实验系统\文档\照片\备用\IMG_6857 抠图.jpg" width="327" height="151"></span></p>
</div>
<div class="paragraph">
<p>图 2 DE2-115 + JUPOD</p>
</div>
</div>
<div class="sect3">
<h4 id="_nexys4ddr_jupod调试适配器"><a class="anchor" href="#_nexys4ddr_jupod调试适配器"></a>Nexys4DDR + JUPOD调试适配器</h4>
<div class="paragraph">
<p>JUPOD调试适配器通过扁平电缆连接Nexys4DDR开发板右侧中部的JA连接器的下排插孔。通过USB电缆连接PC机。在电脑驱动尚未成功识别JUPOD调试适配器时，左边的双色指示灯的红色灯亮；识别到调试适配器后，红灯熄灭、绿色灯点亮。实验板上电后，右边的蓝色指示灯点亮。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/L02b-image3.jpeg" alt="IMG_7725抠图" width="327" height="117"></span></p>
</div>
<div class="paragraph">
<p>图 3 Nexys4DDR + JUPOD</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_安装驱动程序"><a class="anchor" href="#_安装驱动程序"></a>安装驱动程序</h3>
<div class="paragraph">
<p>有两种类型的调试适配器，一种需要安装驱动程序，另一种使用Windows自带的驱动。外观上无法区分是否需要安装驱动程序，请向指导教师咨询。目前的调试适配器通常无需安装驱动程序，但是加载FPGA电路的时间稍长。</p>
</div>
<div class="paragraph">
<p>这里介绍32位Win7和WinXP的驱动程序安装，64位Windows系统（如Win10）的安装方法请自行百度。</p>
</div>
<div class="paragraph">
<p>调试适配器或内置调试适配器的实验板和PC机通过USB电缆连接后，在弹出的“安装驱动程序向导”窗口中，选择“从列表或指定位置安装”，根据提示点击“下一步”，浏览到驱动程序在软件包中的位置，根据提示点击“下一步”，即可完成JUPOD驱动程序安装。</p>
</div>
<div class="paragraph">
<p>驱动安装成功后，实验板/调试适配器的绿色指示灯会点亮，见上述“实验板硬件连接”的说明。如果绿色指示灯没有点亮，请检查Windows“设备管理器”的“通用串行总线控制器” 设备列表中是否出现“JU-POD”或“JU-HID”以及是否有感叹号。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="注"></i>
</td>
<td class="content">
关于指示灯的进一步说明：绿色指示灯一般保持常亮，表示与计算机的连接正常，但是对于使用Windows自带驱动的调试适配器，在大部分win10系统下，几秒钟后绿色指示灯会自动熄灭，当操作实验软件与实验板传送数据时绿色指示灯又会自动点亮，这是正常现象。红色指示灯仅在有数据传输时闪烁。
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="验证流程"><a class="anchor" href="#验证流程"></a>实验验证流程</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_打开虚拟实验板"><a class="anchor" href="#_打开虚拟实验板"></a>打开虚拟实验板</h3>
<div class="paragraph">
<p>启动WeLab软件后，点击“打开虚拟面板”菜单项或工具条按钮，在打开的文件对话框中选择实验材料中<em>虚拟实验板.jvp</em>，打开后界面如图 4，这个虚拟面板以实验板的实物照片为背景，在开关、指示灯等输入输出元件位置上放置了虚拟元件。</p>
</div>
<div class="paragraph">
<p>将鼠标指针指向某个虚拟元件，会提示该元件的名称和序号，如最右边的开关提示“开关0”，这些虚拟元件的名称与设计模块端口名称相对应。如“开关7”～“开关0”，与Verilog代码中的S[7:0]对应；同样，虚拟面板中序号为“0”的数码管与代码中的“SD0”对应。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/L02b-image4.png" alt="image" width="555" height="352"></span></p>
</div>
<div class="paragraph">
<p>图 4 DE2-115虚拟面板</p>
</div>
</div>
<div class="sect2">
<h3 id="_与调试适配器建立连接"><a class="anchor" href="#_与调试适配器建立连接"></a>与调试适配器建立连接</h3>
<div class="paragraph">
<p>点击“调试适配器”菜单项或工具条按钮，在弹出窗口中应已经列出发现的调试适配器，如图 5，点击“连接”按钮。若列表中未出现调试适配器，请检查实验板与计算机的连接。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/L02b-image5.png" alt="image" width="281" height="209"></span></p>
</div>
<div class="paragraph">
<p>图 5 连接调试适配器</p>
</div>
</div>
<div class="sect2">
<h3 id="_加载fpga电路"><a class="anchor" href="#_加载fpga电路"></a>加载FPGA电路</h3>
<div class="paragraph">
<p>开始验证之前首先要将前面实验编译生成的FPGA电路文件加载到FPGA芯片中（也称配置、编程、下载）。内置调试适配器的Pocket口袋板通过实验软件下载FPGA。</p>
</div>
<div class="paragraph">
<p>点击“下载FPGA”工具条按钮或菜单项，在打开的文件对话框中选择之前编译生成的xxx<em>.rbf</em>文件后开始编程，编程过程中会在菜单栏位置出现进度条，完成后会有提示“配置FPGA成功”。</p>
</div>
<div class="paragraph">
<p>独立调试适配器不能配置FPGA，如DE2-115实验板需要使用Quartus软件下载，具体操作见附录。Nexys4DDR实验板需要使用Vivado软件下载，另文介绍。</p>
</div>
</div>
<div class="sect2">
<h3 id="_操作虚拟面板"><a class="anchor" href="#_操作虚拟面板"></a>操作虚拟面板</h3>
<div class="paragraph">
<p>点击虚拟面板中的拨动开关S7～S0，观察数码管0显示内容的变化；点击虚拟开关S8～S11，相应的LED指示灯应该点亮。如果与预期不同，检查前面的设计代码是否正确。</p>
</div>
<div class="paragraph">
<p>如果实际实验板有真实的数码管，如DE2-115，实验板上的数码管也会同步显示。Pocket实验板没有实际的数码管，只能在虚拟实验板上显示。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="设计虚拟面板"><a class="anchor" href="#设计虚拟面板"></a>设计虚拟面板</h2>
<div class="sectionbody">
<div class="paragraph">
<p>下面从头设计一个全新的虚拟面板。点击“实验板—&gt;新建虚拟面板”菜单项或工具条按钮，输入虚拟面板名称“认识虚拟元件”；点击“设计—&gt;添加更换背景图”菜单项或工具条按钮，实验材料中提供了一个“虚拟面板背景图.jpg”文件，选择该图片作为虚拟面板背景图，如图 6。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/L02b-image6.png" alt="image" width="317" height="253"></span></p>
</div>
<div class="paragraph">
<p>图 6 七段数码管实验虚拟面板</p>
</div>
<div class="paragraph">
<p>现在我们给虚拟面板添加虚拟元件。以虚拟开关为例，在设计工具箱中点击“开关”，点击“开关0”，将它们添加到虚拟面板上，然后将它拖到所希望的位置。用类似的方法添加需要的开关、数码管和指示灯。最终完成虚拟面板效果如图 7。点击“保存虚拟面板”菜单或工具按钮将面板设计保存到文件。</p>
</div>
<div class="paragraph">
<p>上面介绍的是从空白开始设计一个全新的虚拟面板，实际上已有虚拟面板也可以修改，只要点击“模式—&gt;虚拟面板设计”菜单项或笔形工具按钮，进入设计状态即可修改虚拟面板。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/L02b-image7.png" alt="image" width="317" height="253"></span></p>
</div>
<div class="paragraph">
<p>图 7</p>
</div>
<div class="paragraph">
<p>完成虚拟面板设计后，点击“模式—&gt;虚拟面板设计”菜单项或工具按钮，从设计模式转换为实验模式。拨动虚拟开关，观察数码管和指示灯显示是否正确。如果不正确，检查verilog设计是否存在错误，改正错误后重新验证。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_实验考核"><a class="anchor" href="#_实验考核"></a>实验考核</h2>
<div class="sectionbody">
<div class="paragraph">
<p>线下实验的考核由指导老师现场检查。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Quartus下载sof"><a class="anchor" href="#Quartus下载sof"></a>附：使用Quartus软件下载sof文件</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DE2-115使用Quartus软件通过JTAG接口下载sof文件。</p>
</div>
<div class="paragraph">
<p>点击工具栏<span class="image"><img src="_images/L02b-image8.png" alt="image" width="23" height="22"></span>按钮，或使用菜单项Tool&#8594;Programmer进入器件编程话框，如图 8。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/L02b-image9.png" alt="image" width="424" height="263"></span></p>
</div>
<div class="paragraph">
<p>图 8 器件编程</p>
</div>
<div class="paragraph">
<p>单击<span class="image"><img src="_images/L02b-image10.png" alt="image" width="133" height="24"></span>按钮，选择USB-Blaster作为编程硬件，如图 9。</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/L02b-image11.png" alt="image" width="343" height="202"></span></p>
</div>
<div class="paragraph">
<p>图 9 下载电缆设置</p>
</div>
<div class="paragraph">
<p>回到图 8编程界面，在Mode中选择编程模式，使用JTAG模式。勾选Program/Configure选项框，单击<span class="image"><img src="_images/L02b-image12.png" alt="image" width="100" height="24"></span>按钮开始器件编程。在Process进度条中会显示编程进度。</p>
</div>
<div class="paragraph">
<p>完成后，在QuartusII的信息显示区中，会报告成功或出错信息；注意：信息显示在QuartusII主界面的信息显示区中，不在编程窗口中；为了方便看到提示信息，可以从Window菜单执行Attach Window，将编程窗口嵌入到QuartusII主界面中。</p>
</div>
<div class="paragraph">
<p>编程界面左侧的其它按钮分别表示停止编程；自动检测编程硬件是否连接；删除编程文件；更改选中的编程文件；保存文件；添加用户自定义的器件；更改编程文件的顺序。</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">许可 | License</div>
<div class="paragraph">
<p><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA：署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></p>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
