<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Quartus FPGA设计流程 :: RISC-V CPU设计实验教程</title>
    <meta name="generator" content="Antora 3.1.2">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">RISC-V CPU设计实验教程</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jurv" data-version="sp2023">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">RISC-V CPU设计实验教程</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">前言</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="brief-of-parts.html">实验内容的组织</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="video-links.html">教学视频资源</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">实验工具和环境</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="L02-lab-tools.html">实验工具和环境概述</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="L01-guide.html">Quartus FPGA设计流程</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#准备工作">准备工作</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#实验步骤">实验步骤</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#云端编译">云端编译</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L01b-tcl-create-quartus-project.html">用TCL文件快速创建工程</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="L02-guide-remote.html">远程实验验证流程</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="L02-guide-remote.html#准备工作">准备工作</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="L02-guide-login.html">登录远程实验平台</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-remote.html#验证流程">验证流程</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-remote.html#设计虚拟面板">设计虚拟面板</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-remote.html#实验考核">实验考核</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="L02-guide-local.html">本地实验验证流程</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-local.html#准备工作">准备工作</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-local.html#验证流程">验证流程</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-local.html#设计虚拟面板">设计虚拟面板</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-local.html#Quartus下载sof">使用Quartus软件下载sof文件</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">SystemVerilog和逻辑电路实验</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">SystemVerilog概述</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">组合逻辑电路的SystemVerilog描述（上）</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">三态门和多路器实验</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">组合逻辑电路的SystemVerilog描述（下）</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">译码器实验</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">时序逻辑电路的SystemVerilog描述（上）</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">寄存器堆实验</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">时序逻辑电路的SystemVerilog描述（中）</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">流水灯和移位寄存器实验</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">时序逻辑电路的SystemVerilog描述（下）</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">计数器和分频器实验</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">有限状态机的SystemVerilog描述</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">彩灯控制器</span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">计算机组成实验</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">加法器和比较器实验</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">算术逻辑单元实验</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">存储器实验</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">RISC-V汇编语言实验</span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">RISC-V CPU设计实验</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">实现ADDI指令</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">实现整数运算指令</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">实现访存指令和简单IO</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">实现分支指令</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">初步实现流水线</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">支持27条指令</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">解决流水线数据冲突</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">解决流水线控制冲突</span>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">RISC-V CPU设计实验教程</span>
    <span class="version">sp2023</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../teach/index.html">FPGA实验云 ● 教师指南</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../teach/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="index.html">RISC-V CPU设计实验教程</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">sp2023</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">RISC-V CPU设计实验教程</a></li>
    <li>实验工具和环境</li>
    <li><a href="L01-guide.html">Quartus FPGA设计流程</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Quartus FPGA设计流程</h1>
<div class="sect1">
<h2 id="_实验目的"><a class="anchor" href="#_实验目的"></a>实验目的</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>熟悉FPGA设计流程；</p>
</li>
<li>
<p>熟悉Quartus设计软件的使用；</p>
</li>
<li>
<p>掌握Verilog HDL的模块、端口和持续赋值语句。</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="准备工作"><a class="anchor" href="#准备工作"></a>准备工作</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_安装fpga_设计软件"><a class="anchor" href="#_安装fpga_设计软件"></a>安装FPGA 设计软件</h3>
<div class="paragraph">
<p>本教程使用的设计软件为：Quartus Prime 20.1.1。Quartus Prime分为Pro、Standard 和 Lite Edition，其中 Lite（精简版）是免费的，完全能够满足教学使用，因此建议安装Lite Edition。软件可从Intel官方网站（https://fpgasoftware.intel.com/）下载，同时需要下载支持Cyclone IV E器件的Cyclone器件库。安装时只要将下载的器件库和Quartus安装程序放在同一个文件夹，安装程序会自动搜寻器件库并默认选择所包含的器件系列；本教程使用Cyclone IV系列的器件。也可以使用其他版本的Quartus设计软件，支持Cyclone IV E器件即可，只是在界面菜单操作等细节上可能与本教程不完全相同。</p>
</div>
<div class="paragraph">
<p>安装时采用软件的默认设置即可。如果要改变安装路径，注意安装路径不要有汉字和空格。</p>
</div>
</div>
<div class="sect2">
<h3 id="_下载实验材料创建工程文件夹"><a class="anchor" href="#_下载实验材料创建工程文件夹"></a>下载实验材料、创建工程文件夹</h3>
<div class="paragraph">
<p>课程网站中提供了一些实验材料文件，在开始之前首先要下载<em>LabProject.zip</em>这个压缩包。课程网站的网址由指导教师公布。</p>
</div>
<div class="paragraph">
<p>将<em>LabProject.zip</em>解压到一个文件夹作为工程文件夹。同样要注意，工程文件夹的名称和路径均不能包含空格和汉字；也不建议把工程文件夹建在桌面上。学校实验室计算机通常安装硬盘保护系统，不要在被保护的硬盘分区（包括桌面）创建工程文件夹，一般盘符靠后的如E盘是开放的。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content">
Quartus软件安装路径不要有汉字和空格。工程文件夹的名称和路径均不能包含汉字和空格。
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="实验步骤"><a class="anchor" href="#实验步骤"></a>实验步骤</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_新建工程"><a class="anchor" href="#_新建工程"></a>新建工程</h3>
<div class="paragraph">
<p>运行Quartus软件。点击菜单项File ➤ New Project Wizard…，出现introduction对话框。单击Next，进入Directory，name，Top-Level Entity设置对话框，选择前面创建的工程文件存放路径，输入工程名称和顶层模块名称。点击Next，进入Project Type对话框，选择Empty project。</p>
</div>
<div class="paragraph">
<p>点击Finish，完成工程创建。完成后，Quartus界面如<a href="#fig-1">图 1</a>所示。</p>
</div>
<div id="fig-1" class="imageblock">
<div class="content">
<img src="_images/L01-image1.png" alt="image">
</div>
<div class="title">图 1. Quartus Prime界面</div>
</div>
</div>
<div class="sect2">
<h3 id="_配置工程"><a class="anchor" href="#_配置工程"></a>配置工程</h3>
<div class="sect3">
<h4 id="_导入设计文件"><a class="anchor" href="#_导入设计文件"></a>导入设计文件</h4>
<div class="paragraph">
<p>点击菜单项Project ➤ ADD/Remove Files in Project…，出现category Files对话框。该对话框用来将已存在的设计文件加入到工程中。点击<span class="image"><img src="_images/L01-image2.png" alt="image" width="24" height="19"></span>按钮，选择已经解压在工程文件夹内的Design Files（<em>GlobalCLK.v</em>，<em>LabBoard_TOP.v</em>，<em>pll.v</em>，<em>WatchChain.sv</em>和<em>JutagScanChain.qxp</em>），添加到工程中。这些文件是虚拟实验系统所需要的基础文件，用户不应该去修改它们，通常也无需理解其中的代码。</p>
</div>
</div>
<div class="sect3">
<h4 id="_设置顶层模块"><a class="anchor" href="#_设置顶层模块"></a>设置顶层模块</h4>
<div class="paragraph">
<p>下拉Project Navigator右边的列表框，选择Files，如<a href="#fig-2">图 2</a>(a)，可以看到已添加到工程中的文件。右键点击<em>LabBoard_TOP.v</em>，在弹出菜单中选择Set as Top-Level Entity，将该文件设置为顶层模块，设置完成后的Hierarchy如<a href="#fig-2">图 2</a>(b)。</p>
</div>
<div id="fig-2" class="imageblock">
<div class="content">
<img src="_images/L01-image3ab.png" alt="image">
</div>
<div class="title">图 2. 设置顶层模块</div>
</div>
</div>
<div class="sect3">
<h4 id="_设置输出路径"><a class="anchor" href="#_设置输出路径"></a>设置输出路径</h4>
<div class="paragraph">
<p>虽然设置输出路径不是必须，但可以使得工程文件夹的文件组织便于管理。点击菜单Assignments ➤ Settings或工具栏相应按钮，在打开的对话框Category栏选择Compillation Process Settings，在右边的设置项中勾选Save project output files in specified directory，在Directory name编辑框内输入“./output”。</p>
</div>
</div>
<div class="sect3">
<h4 id="_选择硬件描述语言版本"><a class="anchor" href="#_选择硬件描述语言版本"></a>选择硬件描述语言版本</h4>
<div class="paragraph">
<p>接着在settings对话框Category栏的Compiler Settings下选择Verilog HDL Input，默认的Verilog版本是Verilog-2001，这里改为SystemVerilog。如果选择Verilog-2001，编译器将根据文件后缀名来决定使用的语言，“.v”是Verilog，“.sv”是SystemVerilog。</p>
</div>
</div>
<div class="sect3">
<h4 id="_设置器件和引脚选项"><a class="anchor" href="#_设置器件和引脚选项"></a>设置器件和引脚选项</h4>
<div class="paragraph">
<p>点击菜单项Assignments ➤ Device…，出现Device对话框，根据使用的实验板在Device Family列表和Available devices列表中找到所用的FPGA器件。 远程实验板和口袋实验板的FPGA型号是Cyclone IV E系列的EP4CE6E22C8，DE2-115开发板的FPGA型号为EP4CE115F29C7。</p>
</div>
<div class="paragraph">
<p>在Device对话框中点击“Device and Pin Options …”出现Device and Pin Options对话框，在该对话框中：</p>
</div>
<div class="paragraph">
<p>选择Category列表中的“Programming Files”，勾选Raw Binary File (.rbf)。远程实验板及口袋实验板需要rbf文件作为FPGA编程文件。DE2-115实验板使用JTAG方式编程，可以不勾选生成rbf文件。</p>
</div>
<div class="paragraph">
<p>选择Category列表中的Category列表中选择“Unused Pins”，设置为“As input tri-stated with weak pull-up”。</p>
</div>
<div class="paragraph">
<p>选择Category列表中的“Dual-Purpose Pins”，将“nCEO”设置为“Use as regular I/O”。</p>
</div>
</div>
<div class="sect3">
<h4 id="_设置约束条件"><a class="anchor" href="#_设置约束条件"></a>设置约束条件</h4>
<div class="paragraph">
<p>约束引脚是将顶层模块（LabBoard_TOP）的输入输出端口指定到FPGA器件的实际引脚。约束引脚有手工约束和导入约束文件两种方法。</p>
</div>
<div class="paragraph">
<p>为了节省时间，本实验采用运行tcl脚本文件的方法导入约束条件，实验材料的<em>LabProject</em>文件夹中提供了<em>RemotePocket.tcl</em>文件（注：该文件适用于远程实验板及口袋实验板）。点击 View菜单中的 Tcl Console 菜单项打开 “Tcl Console” 子窗口。点击Tools菜单中的Tcl Scripts项，在弹出的窗口中选择<em>RemotePocket.tcl</em>。如果<em>RemotePocket.tcl</em>没有出现在窗口中，有可能是前面准备工作时没有将<em>LabProject.zip</em>中的该文件放在工程文件夹内，这种情况下可以将<em>RemotePocket.tcl</em>文件单独拷贝到工程文件夹即可。</p>
</div>
<div class="paragraph">
<p>点击&lt;Run&gt;按钮执行该脚本文件，之后会弹出一个信息框提示“Tcl Script File &#8230;&#8203; executed”。 但是，这并不代表执行成功了，如果出错，会在 “Tcl Console” 子窗口显示红色的错误信息，这也是要打开“Tcl Console” 子窗口的原因。常见的错误原因是工程路径中包含了空格或汉字。也可以手工检查是否执行成功，执行菜单Assignment ➤ Assignment Editor或者Assignment ➤ Pin Planner，打开的窗口内容如果是有内容的，说明导入成功。顺便说明，Assignment Editor和Pin Planner窗口也可以用于手工约束引脚。</p>
</div>
<div class="paragraph">
<p>实际上<em>RemotePocket.tcl</em>脚本文件不仅有引脚定义信息，还包含了前面通过图形界面所做的一些设置。此外，还有一种导入引脚约束的方法是用菜单Assignments ➤ Import Assignments…导入qsf或csv等文件，本实验不做练习。</p>
</div>
<div class="paragraph">
<p>需要说明的是，本课程的实验采用虚拟实验方式，同学们的设计并不直接使用顶层端口，但是仍然需要进行引脚约束，否则使用虚拟实验调试系统的时候会出现问题。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_保存工程"><a class="anchor" href="#_保存工程"></a>保存工程</h3>
<div class="paragraph">
<p>至此新的工程框架才算真正建立完成，从上面的过程可以看出，工程的配置需要花费一定的时间。所以要把本实验所建的工程保存好，以便后面的实验继续使用。执行菜单File ➤ Save Project和File ➤ Close Project保存工程后关闭工程。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="注"></i>
</td>
<td class="content">
如果自己创建的工程出现问题，可以参照<a href="L01b-tcl-create-quartus-project.html" class="xref page">“用TCL文件自动创建Quartus工程”</a>，高效率地创建工程。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_打开工程"><a class="anchor" href="#_打开工程"></a>打开工程</h3>
<div class="paragraph">
<p>使用菜单项File ➤ Open Project重新打开前面创建的工程。</p>
</div>
</div>
<div class="sect2">
<h3 id="_错误信息"><a class="anchor" href="#_错误信息"></a>错误信息</h3>
<div class="paragraph">
<p>点击Processing ➤ Start菜单的Start Analysis &amp; Synthesis项或工具栏相应按钮，使用Quartus软件内嵌的分析综合工具Analysis &amp; Synthesis对设计进行逻辑综合。如果综合通过，任务流程区中Analysis &amp; Synthesis步骤前面会显示绿色的勾；如果有语法错误，会显示红色的叉，同时在信息显示区会显示错误信息。</p>
</div>
<div class="paragraph">
<p>查找错误时，应从第一个错误信息看起，因为后面的错误有可能是由前面的错误引起的。应点击Error标签，翻到第一个错误信息，如<a href="#fig-3">图 3</a>。</p>
</div>
<div id="fig-3" class="imageblock">
<div class="content">
<img src="_images/L01-image5.png" alt="image">
</div>
<div class="title">图 3. Messages窗口的错误提示信息</div>
</div>
<div class="paragraph">
<p>“Error (12006): Node instance "Lab_inst" instantiates undefined entity "VirtualBoard". ”这个错误信息是说编译器没找到“VirtualBoard”这个模块。</p>
</div>
<div class="paragraph">
<p>很多初学者不习惯阅读错误信息，实际上学会读懂错误信息是很有用的。可以点鼠标右键将错误信息复制下来，百度看看过来人怎么说，慢慢地就能读懂了。</p>
</div>
</div>
<div class="sect2">
<h3 id="_添加模块"><a class="anchor" href="#_添加模块"></a>添加模块</h3>
<div class="sect3">
<h4 id="_添加已有的模块"><a class="anchor" href="#_添加已有的模块"></a>添加已有的模块</h4>
<div class="paragraph">
<p>用菜单项Project ➤ Add/Remove Files in Project… 打开添加文件对话框，点击<span class="image"><img src="_images/L01-image2.png" alt="image" width="24" height="19"></span>按钮，将实验材料中的<em>VirtualBoard.sv</em>添加到工程。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="注"></i>
</td>
<td class="content">
如果希望用VHDL，实验材料也提供了<em>VirtualBoard.vhd</em>。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>再次Start Analysis &amp; Synthesis，此时综合应该没有报错了。</p>
</div>
</div>
<div class="sect3">
<h4 id="_新建模块"><a class="anchor" href="#_新建模块"></a>新建模块</h4>
<div class="paragraph">
<p>在以后的实验中，我们还会需要新建模块，这里一起介绍。点击菜单项File ➤ new…，出现新建源文件对话框，可以新建一个SystemVerilog HDL File或者Verilog HDL File等类型的设计文件。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_设计输入"><a class="anchor" href="#_设计输入"></a>设计输入</h3>
<div class="sect3">
<h4 id="_输入hdl设计代码"><a class="anchor" href="#_输入hdl设计代码"></a>输入HDL设计代码</h4>
<div class="paragraph">
<p>前面的综合虽然没有报错，但实际上VirtualBoard模块并没有设计内容。在编辑器中打开<em>VirtualBoard.sv</em>文件，如<a href="#虚拟实验板模块">例 1</a>所示，可以看到该模块只有端口定义。</p>
</div>
<div id="虚拟实验板模块" class="exampleblock">
<div class="title">例 1. 虚拟实验板模块</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-verilog hljs" data-lang="verilog">`default_nettype none 
module VirtualBoard (
    input  wire   CLOCK,      // 10 MHz Input Clock 
    input  wire  [19:0] PB,   // 20 Push Buttons, logical 1 when pressed
    input  wire  [35:0] S,    // 36 Switches
    output logic [35:0] L,    // 36 LEDs, drive logical 1 to light up
    output logic  [7:0] SD7,  // 8 common anode Seven-segment Display
    output logic  [7:0] SD6,
    output logic  [7:0] SD5,
    output logic  [7:0] SD4,
    output logic  [7:0] SD3,
    output logic  [7:0] SD2,
    output logic  [7:0] SD1,
    output logic  [7:0] SD0
); 

endmodule</code></pre>
</div>
</div>
</div>
</div>
<details>
<summary class="title"><a href="#虚拟实验板模块">例 1</a>的VHDL版本（点击此行展开）</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-vhdl hljs" data-lang="vhdl">LIBRARY ieee;
USE ieee.std_logic_1164.ALL;
USE ieee.std_logic_unsigned.ALL;
ENTITY  VirtualBoard IS
PORT (   
   CLOCK:in std_logic;                     -- 10MHz Input Clock 
   PB: in  std_logic_vector(19 downto 0);  -- 20 Push buttons, logical 1 when pressed
   S:  in  std_logic_vector(35 downto 0);  -- 36 Switches
   L:  out std_logic_vector(35 downto 0);  -- 36 LEDs, drive logical 1 to light up
   SD7:out std_logic_vector(7 downto 0);   -- 8 common anode Seven-segment Display
   SD6:out std_logic_vector(7 downto 0);
   SD5:out std_logic_vector(7 downto 0);
   SD4:out std_logic_vector(7 downto 0);
   SD3:out std_logic_vector(7 downto 0);
   SD2:out std_logic_vector(7 downto 0);
   SD1:out std_logic_vector(7 downto 0);
   SD0:out std_logic_vector(7 downto 0)); 
END VirtualBoard;

ARCHITECTURE  behav_VB OF  VirtualBoard IS

BEGIN


END behav_VB;</code></pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>这个VirtualBoard模块可以想象成一个实验板，有1个时钟输入CLOCK， 20个按键PB，36个拨动开关S，36个指示灯L，8个七段数码管SD0～SD7。该模块命名为“VirtualBoard”的含义是“虚拟实验板”，在后面验证时我们会看到，“虚拟实验板”模块与实验调试软件的“虚拟面板”是相互对应的。</p>
</div>
<div class="paragraph">
<p>下面给VirtualBoard模块添加设计代码。首先用8个拨动开关S7～S0直接驱动七段数码管SD0的8个段，将下面的代码添加到<a href="#虚拟实验板模块">例 1</a>的 <code>endmodule</code> 之前。</p>
</div>
<div id="需添加的代码" class="exampleblock">
<div class="title">例 2. 需添加的代码</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-verilog hljs" data-lang="verilog">   //开关7~0直接驱动数码管SD0的各个段
   assign SD0 = S[7:0];

   //开关11~8驱动指示灯L11~8的亮灭
   <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>在这里添加Verilog HDL的assign赋值语句，实现S11～S8控制L11～L8的亮灭。</td>
</tr>
</table>
</div>
</div>
</div>
<details>
<summary class="title"><a href="#需添加的代码">例 2</a>的VHDL版本（点击此行展开）</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-vhdl hljs" data-lang="vhdl">   //开关7~0直接驱动数码管SD0的各个段
   SD0 &lt;= S(7 downto 0);

   //开关11~8驱动指示灯L11~8的亮灭
   <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>在这里添加VHDL的赋值语句，实现S11～S8控制L11～L8的亮灭。</td>
</tr>
</table>
</div>
</div>
</details>
<div class="paragraph">
<p>在以后的实验中，自己的设计也都是写在VirtualBoard模块中；前面使用<em>LabProject.zip</em>中的<em>LabBoard_TOP</em>等文件建立的工程框架不需要修改。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_编译整个工程"><a class="anchor" href="#_编译整个工程"></a>编译整个工程</h3>
<div class="paragraph">
<p>点击Processing菜单的Start Compilation项或工具栏相应按钮，对设计进行全编译。编译成功后，Tasks任务流程区的各个步骤前显示绿色的勾，Project Navigator工程导航区中显示出模块间的层次结构，如<a href="#fig-6">图 4</a>。</p>
</div>
<div id="fig-6" class="imageblock">
<div class="content">
<img src="_images/L01-image6.png" alt="image">
</div>
<div class="title">图 4. 编译通过</div>
</div>
<div class="paragraph">
<p>有的时候Analysis &amp; Synthesis和Fitter都通过了，但是Assembler或Timing Analysis没有通过，此时只要在任务流程区双击该步骤重做一次，一般都能成功。</p>
</div>
<div class="paragraph">
<p>在<em>output</em>文件夹下找到生成的“<em>xxx.rbf</em>”文件，其中xxx是在建立工程时输入的工程名称；这个文件在验证时要用。</p>
</div>
</div>
<div class="sect2">
<h3 id="_存档整个工程"><a class="anchor" href="#_存档整个工程"></a>存档整个工程</h3>
<div class="paragraph">
<p>点击Project菜单的Archive Project项，将整个工程存档，存档文件的扩展名为<em>.qar</em>。以后可以用Restore Archived Project菜单项恢复存档的工程。当然，也可以用文件压缩工具将工程文件夹打包保存。使用Archive Project的好处是不会遗漏任何源文件，而且存档文件尺寸较小。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="云端编译"><a class="anchor" href="#云端编译"></a>关于云端编译</h2>
<div class="sectionbody">
<div class="paragraph">
<p>远程实验平台支持云端编译，不需要在本地计算机上安装Quartus软件，也就不需要上面的新建工程、配置工程等步骤，具体用法在后面的实验中结合远程实验平台介绍。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="验证设计"><a class="anchor" href="#验证设计"></a>验证设计</h2>
<div class="sectionbody">
<div class="paragraph">
<p>测试验证首先要将上面编译生成的编程文件下载到FPGA，然后对实验电路施加输入激励，并读回输出响应进行分析判断。传统实验验证方式使用实验板上的开关等元件施加输入，通过实验板上的指示灯、数码管等观察实验现象；本课程使用虚拟实验调试软件进行实验验证，有本地实验和远程实验两种版本的实验软件，对应使用的实验电路板的不同（远程实验使用远程实验板，本地实验使用口袋实验板等），FPGA电路的加载方法也有所不同。请根据所使用的实验板和实验调试软件，参阅相应的 <a href="L02-guide-remote.html" class="xref page">《FPGA实验验证流程（远程版）》</a>或 <a href="L02-guide-local.html" class="xref page">《FPGA实验验证流程（本地版）》</a>。</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">许可 | License</div>
<div class="paragraph">
<p><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA：署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></p>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
