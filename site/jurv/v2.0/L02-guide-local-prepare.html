<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: RISC-V CPU设计实验教程</title>
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">RISC-V CPU设计实验教程</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="http://welab.ujs.edu.cn/new" target="_blank">Home</a>

        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://gitee.com/fpga-lab/jurv-open" target="_blank">openJURV</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jurv" data-version="v2.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">RISC-V CPU设计实验教程</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">前言</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="brief-of-parts.html">实验内容的组织</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="video-links.html">教学视频资源</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">实验工具和环境</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="L02-lab-tools.html">实验工具和环境概述</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">实验前的准备工作</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L0-install-software.html">安装软件</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L0-download-resource.html">下载实验材料</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L0-mooc-video.html">登录慕课平台</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L0-welab-login.html">登录远程实验平台</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">设计工具</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L01-guide.html">Quartus FPGA设计流程</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L01c-quartus-revision.html">线上线下混合模式的工程设置</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">验证环境</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-remote.html">远程实验验证流程</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-local-welab.html">本地实验验证流程-WeLab版</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="L02-guide-local-julab.html">本地实验验证流程-JULAB版</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Verilog与逻辑电路实验</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/sv1-introduction.html">Verilog HDL概述</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/sv2-grammar.html">Verilog HDL语法概要</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/sv3-1-combinational.html">用assign持续赋值语句描述组合逻辑</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/L11-tristate_mux.html">三态门和多路器实验</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/sv3-2-combinational.html">用always过程语句描述组合逻辑</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/sv5-hierarchical.html">层次化和参数化设计</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/L12-decoder.html">译码器实验</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/sv4-sequential.html">时序逻辑的Verilog HDL描述</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/L13-register_file.html">寄存器堆实验</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/L14-shift_led.html">流水灯与移位寄存器实验</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/L15-counter_divider.html">计数器与分频器实验</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/sv6-control.html">顺序控制逻辑的Verilog HDL描述</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/L16-led_pattern_controller.html">彩灯控制器实验</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sv-docs/L17-stream_cipher.html">流密码器实验</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">计算机组成实验</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ca-docs/L21-add_sub_operation.html">加减运算电路实验</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ca-docs/L22-arithmetic_logic_unit.html">算术逻辑单元实验</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ca-docs/L23-single_cycle_datapath.html">单周期数据通路实验</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ca-docs/L24-memory.html">存储器实验</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ca-docs/L25-hardwire_controller.html">硬布线控制实验</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ca-docs/L26-riscv_assembly.html">RISC-V汇编语言实验</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ca-docs/L27-riscv_micro_architecture.html">RISC-V微架构实验</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">RISC-V CPU设计实验</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rv-docs/RV01-guide.html">实现ADDI指令</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rv-docs/RV15-guide.html">实现整数运算指令</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rv-docs/RV17-guide.html">实现访存指令和简单IO</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rv-docs/RV23-guide.html">实现分支指令</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rv-docs/RV23PL-guide.html">初步实现流水线</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rv-docs/RV27-guide.html">支持27条指令</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rv-docs/RV27PL1-guide.html">解决流水线数据冲突</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rv-docs/RV27PL2-guide.html">解决流水线控制冲突</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">RISC-V CPU设计实验教程</span>
    <span class="version">2023秋</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../teach/index.html">FPGA实验云 ● 教师指南</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../teach/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="index.html">RISC-V CPU设计实验教程</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">2023秋</a>
        </li>
        <li class="version">
          <a href="../v1.0/index.html">2023春</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">2023秋</button>
  <div class="version-menu">
    <a class="version is-current" href="L02-guide-local-prepare.html">2023秋</a>
    <a class="version" href="../v1.0/L02-guide-local-prepare.html">2023春</a>
  </div>
</div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="页内目录" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="sect3">
<h4 id="_下载实验材料"><a class="anchor" href="#_下载实验材料"></a>下载实验材料</h4>
<div class="paragraph">
<p>本书所有实验项目的附件材料发布在开源项目托管网站<a href="https://gitee.com/fpga-lab/jurv-open" class="bare">https://gitee.com/fpga-lab/jurv-open</a>，其中<em>labs/L02</em>目录是本项目的实验材料，包含了虚拟面板等文件。</p>
</div>
</div>
<div class="sect3">
<h4 id="_安装实验调试软件"><a class="anchor" href="#_安装实验调试软件"></a>安装实验调试软件</h4>
<div class="paragraph">
<p>首先从<a href="https://gitee.com/fpga-lab/jurv-open">openJURV</a>开源项目的software文件夹下载<em>welab.zip</em>或<em>julab.zip</em>压缩包到本地硬盘，解压即可。</p>
</div>
</div>
<div class="sect3">
<h4 id="_实验板硬件连接"><a class="anchor" href="#_实验板硬件连接"></a>实验板硬件连接</h4>
<div class="paragraph">
<p>实验软件可与多种硬件实验板配套，大致分为两种类型，一种是独立的调试适配器+实验/开发板，如DE2-115和Nexys4DDR；另一种是实验板内置调试适配器，如Pocket口袋板。下面分别介绍这三种实验板的连接。</p>
</div>
<div class="sect4">
<h5 id="_pocket口袋板"><a class="anchor" href="#_pocket口袋板"></a>Pocket口袋板</h5>
<div class="paragraph">
<p>Pocket口袋板（<a href="#fig-1">Pocket口袋实验板</a>）和PC机通过USB电缆连接后，口袋板上的蓝色电源指示灯点亮，右侧16个红色灯和8个绿色灯也处于半亮状态。之后Windows系统开始识别设备，见<a href="#驱动程序安装">驱动程序安装</a>。</p>
</div>
<div id="fig-1" class="imageblock">
<div class="content">
<img src="_images/L02b-image1.jpeg" alt="IMG_9130_裁剪" width="294" height="227">
</div>
<div class="title">Figure 1. Pocket口袋实验板</div>
</div>
</div>
<div class="sect4">
<h5 id="_de2_115_jupod调试适配器"><a class="anchor" href="#_de2_115_jupod调试适配器"></a>DE2-115 + JUPOD调试适配器</h5>
<div class="paragraph">
<p>首先确保DE2-115开发板处于断电状态，将JUPOD调试适配器通过扁平电缆连接DE2-115开发板左侧红色电源开关下方的14脚扩展接口，如<a href="#fig-2">DE2-115 + JUPOD</a>所示。DE2-115开发板上电后，调试适配器的蓝色指示灯点亮。调试适配器通过USB电缆连接PC机之后，Windows系统开始识别设备，见<a href="#驱动程序安装">驱动程序安装</a>。</p>
</div>
<div id="fig-2" class="imageblock">
<div class="content">
<img src="_images/L02b-image2.jpeg" alt="IMG_6857 抠图.jpg" width="327" height="151">
</div>
<div class="title">Figure 2. DE2-115 + JUPOD</div>
</div>
<div class="paragraph">
<p>注：DE2-115是友晶科技（Terasic）面向教学科研用途的开发板，使用了Intel/Altera的FPGA芯片。</p>
</div>
</div>
<div class="sect4">
<h5 id="_nexys4ddr_jupod调试适配器"><a class="anchor" href="#_nexys4ddr_jupod调试适配器"></a>Nexys4DDR + JUPOD调试适配器</h5>
<div class="paragraph">
<p>首先确保Nexys4DDR开发板处于断电状态，将JUPOD调试适配器通过扁平电缆连接Nexys4DDR开发板右侧中部的JA连接器的下排插孔，如<a href="#fig-3">Nexys4DDR + JUPOD</a>所示。实验板上电后，调试适配器的蓝色指示灯点亮。调试适配器通过USB电缆连接PC机之后，Windows系统开始识别设备，见<a href="#驱动程序安装">驱动程序安装</a>。</p>
</div>
<div id="fig-3" class="imageblock">
<div class="content">
<img src="_images/L02b-image3.jpeg" alt="IMG_7725抠图" width="327" height="117">
</div>
<div class="title">Figure 3. Nexys4DDR + JUPOD</div>
</div>
<div class="paragraph">
<p>注：Nexys4DDR是Digilent面向教学科研用途的开发板，使用了AMD/Xilinx的FPGA芯片。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="驱动程序安装"><a class="anchor" href="#驱动程序安装"></a>驱动程序安装</h4>
<div class="paragraph">
<p>有两种类型的调试适配器，一种需要手动安装驱动程序，另一种使用Windows自带的驱动。目前大部分调试适配器属于后一种，调试适配器或内置调试适配器的实验板通过USB电缆连接PC机后，Windows系统会自动识别并安装驱动程序。一般首次连接到的电脑需要的时间稍长，对于学校实验室机房有硬盘保护功能的电脑，每次开机后都相当于首次连接，请耐心等待。</p>
</div>
<div class="paragraph">
<p>调试适配器通过指示灯指示驱动是否安装成功。独立调试适配器是一个红绿双色指示灯；口袋实验板在USB接口附近有两个LED指示灯，分别是标注了DATA的红色指示灯和标注了LINK的绿色指示灯。在驱动安装完成之前，红色指示灯亮；驱动安装成功后，红色灯熄灭、绿色指示灯点亮。也可以通过实验软件检查驱动是否安装成功，见<a href="#与调试适配器建立连接">[与调试适配器建立连接]</a>。</p>
</div>
<div class="paragraph">
<p>如果调试适配器通过USB电缆连接电脑后弹出“安装驱动程序向导”窗口，或者在Windows设备管理器的USB设备列表中出现带感叹号的“JU-POD”，说明需要手动安装驱动程序，见附录<a href="#安装USB驱动程序">[安装USB驱动程序]</a>。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
关于指示灯的进一步说明：绿色指示灯一般保持常亮，表示与计算机的连接正常，但是对于使用Windows自带驱动的调试适配器，在大部分win10系统下，几秒钟后绿色指示灯会自动熄灭，当操作实验软件与实验板传送数据时绿色指示灯又会自动点亮，这是正常现象。红色指示灯仅在有数据传输时闪烁。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_设计与编译"><a class="anchor" href="#_设计与编译"></a>设计与编译</h4>
<div class="paragraph">
<p>设计环节在上一个实验中已经完成，并且用Quartus或Vivado软件编译生成了电路文件。为便于后面<a href="#验证流程">[验证流程]</a>的说明，<a href="#exa-02-1-solution">虚拟实验板（VirtualBoard）模块</a>给出了上一个实验的VirtualBoard模块代码。</p>
</div>
<div id="exa-02-1-solution" class="exampleblock">
<div class="title">Example 1. 虚拟实验板（VirtualBoard）模块</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-verilog hljs" data-lang="verilog">`default_nettype none 
module VirtualBoard (
    input  wire   CLOCK,      // 10 MHz Input Clock 
    input  wire  [19:0] PB,   // 20 Push Buttons, logical 1 when pressed
    input  wire  [35:0] S,    // 36 Switches
    output logic [35:0] L,    // 36 LEDs, drive logical 1 to light up
    output logic  [7:0] SD7,  // 8 common anode Seven-segment Display
    output logic  [7:0] SD6,
    output logic  [7:0] SD5,
    output logic  [7:0] SD4,
    output logic  [7:0] SD3,
    output logic  [7:0] SD2,
    output logic  [7:0] SD1,
    output logic  [7:0] SD0
); 

//Switch drives the segment of the seven-segment display
assign SD0 = S[7:0];  <i class="conum" data-value="1"></i><b>(1)</b>

//Switch drives LED 
assign L[11:8] = S[11:8]; <i class="conum" data-value="2"></i><b>(2)</b>

//Push Button drives LED
assign L[18] = PB[0]; <i class="conum" data-value="3"></i><b>(3)</b>
endmodule</code></pre>
</div>
</div>
</div>
</div>
<details id="VHDL版本的虚拟实验板模块">
<summary class="title"><a href="#exa-02-1-solution">虚拟实验板（VirtualBoard）模块</a>的VHDL版本（点击此行展开）</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-vhdl hljs" data-lang="vhdl">LIBRARY ieee;
USE ieee.std_logic_1164.ALL;
USE ieee.std_logic_unsigned.ALL;
ENTITY  VirtualBoard IS
PORT (   
   CLOCK:in std_logic;                     -- 10MHz Input Clock 
   PB: in  std_logic_vector(19 downto 0);  -- 20 Push buttons, logical 1 when pressed
   S:  in  std_logic_vector(35 downto 0);  -- 36 Switches
   L:  out std_logic_vector(35 downto 0);  -- 36 LEDs, drive logical 1 to light up
   SD7:out std_logic_vector(7 downto 0);   -- 8 common anode Seven-segment Display
   SD6:out std_logic_vector(7 downto 0);
   SD5:out std_logic_vector(7 downto 0);
   SD4:out std_logic_vector(7 downto 0);
   SD3:out std_logic_vector(7 downto 0);
   SD2:out std_logic_vector(7 downto 0);
   SD1:out std_logic_vector(7 downto 0);
   SD0:out std_logic_vector(7 downto 0)); 
END VirtualBoard;

ARCHITECTURE  behav_VB OF  VirtualBoard IS

BEGIN

   SD0 &lt;= S(7 downto 0);  <i class="conum" data-value="1"></i><b>(1)</b>
   L(11 downto 8) &lt;= S(11 downto 8);  <i class="conum" data-value="2"></i><b>(2)</b>
   L(18) &lt;= PB(0);  <i class="conum" data-value="3"></i><b>(3)</b>

END behav_VB;</code></pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>这个VirtualBoard模块可以想象成一个实验板，有1个时钟输入CLOCK， 20个按键PB0～PB19，36个拨动开关S0～S35，36个指示灯L0～L35，8个七段数码管SD0～SD7。该模块命名为“VirtualBoard”的含义是“虚拟实验板”，在后面验证时我们会看到，“虚拟实验板”模块与实验调试软件的“虚拟面板”是相互对应的。</p>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
